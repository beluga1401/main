-- Load UI Library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("Vua Ngựa", "Midnight")  -- đổi tên hub ở đây

-- Player setup
local Player = game.Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
local RunService = game:GetService("RunService")

-- Main Tab
local Main = Window:NewTab("Main")
local MainSection = Main:NewSection("Main Controls")

-- Hide/Show UI (smooth, no size change)
local uiVisible = true
MainSection:NewButton("Toggle UI", "Ẩn hoặc hiện toàn bộ UI", function()
    uiVisible = not uiVisible
    if Window and Window.MainFrame then
        Window.MainFrame.Visible = uiVisible
    end
end)

-- NoClip Setup (Stable và hiệu quả)
local noclip = false
MainSection:NewToggle("NoClip", "Đi xuyên tường (ổn định)", function(state)
    noclip = state
    if noclip then
        Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
    else
        Humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
    end
end)

RunService.Heartbeat:Connect(function()
    if noclip and Character and Character.Parent then
        for _, part in pairs(Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
        if HumanoidRootPart then
            HumanoidRootPart.CanCollide = false
        end
    end
end)

-- Speed Hack Setup (Fixed logic)
local speedEnabled = false
local speedMultiplier = 3
local BodyVelocity = nil

MainSection:NewToggle("Speed Hack", "Bật/tắt chạy nhanh", function(state)
    speedEnabled = state
    if state then
        BodyVelocity = Instance.new("BodyVelocity")
        BodyVelocity.MaxForce = Vector3.new(1e5, 0, 1e5)
        BodyVelocity.Parent = HumanoidRootPart
    else
        if BodyVelocity then
            BodyVelocity:Destroy()
            BodyVelocity = nil
        end
        HumanoidRootPart.Velocity = Vector3.new(0, HumanoidRootPart.Velocity.Y, 0)
    end
end)

MainSection:NewSlider("Speed Multiplier", "Điều chỉnh tốc độ chạy", 10, 1, function(s)
    speedMultiplier = s
end)

RunService.RenderStepped:Connect(function()
    if speedEnabled and BodyVelocity then
        BodyVelocity.Velocity = Player.Character.Humanoid.MoveDirection * speedMultiplier * 50
    end
end)

-- Jump Hack Setup
local jumpEnabled = false
local jumpPower = 100

MainSection:NewToggle("Jump Hack", "Bật/tắt nhảy cao", function(state)
    jumpEnabled = state
    if state then
        Humanoid.JumpPower = jumpPower
    else
        Humanoid.JumpPower = 50
    end
end)

MainSection:NewSlider("Jump Power", "Điều chỉnh sức nhảy", 200, 50, function(s)
    jumpPower = s
    if jumpEnabled then
        Humanoid.JumpPower = s
    end
end)

-- 🌈 RGB Hiệu ứng tên hub (tiêu đề)
spawn(function()
    local hue = 0
    while true do
        local color = Color3.fromHSV(hue, 1, 1)
        pcall(function()
            if Window and Window.MainFrame and Window.MainFrame.TopFrame and Window.MainFrame.TopFrame.Title then
                Window.MainFrame.TopFrame.Title.TextColor3 = color
            end
        end)
        hue = hue + 0.005
        if hue > 1 then hue = 0 end
        wait(0.03)
    end
end)
